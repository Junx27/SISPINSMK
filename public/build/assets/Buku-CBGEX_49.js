import{r as a,j as e,M as H,a as J,Y as Q}from"./app-CycvKacP.js";import{D as W,C as X,N as Z,S as O}from"./CreateBook-DTvO8yzN.js";import{u as I}from"./Url-Bx3CnFKe.js";import{E as ee}from"./EditUser-D2Ci1d1G.js";import{B as C}from"./Button-DqIqwc5t.js";import{D as te,P as se}from"./Pagination-B4BZvUQF.js";import{D as d}from"./Dropdown-BzNwB-Q2.js";import{P as K}from"./PopOver-C0JO4fVs.js";import{u as le}from"./index-I_Mwuxvc.js";import"./index-BI6bIyZt.js";import"./transition-Zdt_VaLc.js";function re({id:r,handleClose:p}){const[j,m]=a.useState(!1),{data:i,setData:c,put:w}=le({caption:"",kategori:"",stok:"",penerbit:"",tahun:"",edisi:"",desc:"",imageUrl:null});a.useEffect(()=>{(async()=>{try{const o=await axios.get(`/admin/buku/${r}`);c({caption:o.data.caption,kategori:o.data.kategori,stok:o.data.stok,penerbit:o.data.penerbit,tahun:o.data.tahun,edisi:o.data.edisi,desc:o.data.desc,imageUrl:o.data.imageUrl})}catch(o){console.error(o)}})()},[r]);const g=l=>{l.preventDefault(),w(`/admin/buku-update/${r}`),m(!0)};return e.jsxs("div",{className:"bg-white p-5 rounded-lg w-[700px] shadow-lg",children:[j&&e.jsx(K,{children:e.jsxs("div",{className:"bg-white p-5 rounded-md w-64 h-32",children:[e.jsx("p",{className:"text-center text-xs",children:"Data berhasil dirubah"}),e.jsx("div",{className:"flex justify-center mt-5 cursor-pointer",onClick:()=>window.location.reload(),children:e.jsx("button",{className:"bg-blue-500 text-white rounded-md w-32 p-2",children:"ok"})})]})}),e.jsx("div",{className:"flex justify-end",onClick:p,children:e.jsx("img",{src:"/close.png",alt:"",className:"w-5 h-5"})}),e.jsxs("form",{className:"mt-5 text-xs mx-5 flex flex-row gap-5",onSubmit:g,encType:"multipart/form-data",children:[e.jsxs("div",{className:"w-full mt-3",children:[e.jsx("a",{href:`/admin/buku-foto/${r}`,children:e.jsx("img",{src:i.imageUrl==="null"|i.imageUrl===null?"/default-book.jpg":I+i.imageUrl,alt:"",className:"w-full h-64 object-cover brightness-95 rounded-lg"})}),e.jsx("p",{className:"font-bold mt-5",children:"Caption"}),e.jsx("input",{type:"text",name:"caption",className:"w-full mt-3 text-xs bg-blue-50 hover:bg-blue-100 cursor-pointer rounded-sm outline-none border-0",value:i.caption,onChange:l=>c("caption",l.target.value),required:!0}),e.jsx("p",{className:"font-bold",children:"Kategori"}),e.jsx("input",{type:"text",name:"kategori",className:"w-full mt-3 text-xs bg-blue-50 hover:bg-blue-100 cursor-pointer rounded-sm outline-none border-0",value:i.kategori,onChange:l=>c("kategori",l.target.value),required:!0}),e.jsx("p",{className:"font-bold mt-3",children:"Stok"}),e.jsx("input",{type:"number",name:"stok",className:"w-full mt-3 text-xs bg-blue-50 hover:bg-blue-100 cursor-pointer rounded-sm outline-none border-0",value:i.stok,onChange:l=>c("stok",l.target.value),required:!0})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"font-bold mt-3",children:"Penerbit"}),e.jsx("input",{type:"text",name:"penerbit",className:"w-full mt-3 text-xs bg-blue-50 hover:bg-blue-100 cursor-pointer rounded-sm outline-none border-0",value:i.penerbit,onChange:l=>c("penerbit",l.target.value),required:!0}),e.jsx("p",{className:"font-bold mt-3",children:"Tahun"}),e.jsx("input",{type:"number",name:"tahun",className:"w-full mt-3 text-xs bg-blue-50 hover:bg-blue-100 cursor-pointer rounded-sm outline-none border-0",value:i.tahun,onChange:l=>c("tahun",l.target.value),required:!0}),e.jsx("p",{className:"font-bold mt-3",children:"Edisi"}),e.jsx("input",{type:"text",name:"edisi",className:"w-full mt-3 text-xs bg-blue-50 hover:bg-blue-100 cursor-pointer rounded-sm outline-none border-0",value:i.edisi,onChange:l=>c("edisi",l.target.value),required:!0}),e.jsx("p",{className:"font-bold mt-3",children:"Deskripsi"}),e.jsx("textarea",{name:"desc",className:"w-full mt-3 text-xs bg-blue-50 hover:bg-blue-100 cursor-pointer rounded-sm outline-none border-0",value:i.desc,rows:10,onChange:l=>c("desc",l.target.value),required:!0}),e.jsx("button",{type:"submit",className:"bg-blue-500 text-white mt-3 rounded-md text-xs p-2 w-full",children:"Simpan perubahan"})]})]})]})}function ae({data:r}){const p=a.useRef(),{value:j,setValue:m}=a.useContext(H),i=[...new Set(r.map(t=>t.kategori.toLocaleLowerCase()))],c=[...new Set(r.map(t=>t.tahun.toLocaleLowerCase()))],w=[...new Set(r.map(t=>t.penerbit.toLocaleLowerCase()))],g=[...new Set(r.map(t=>t.edisi.toLocaleLowerCase()))],l=10,[o,L]=a.useState(1),[f,N]=a.useState([]),[u,S]=a.useState(null),[P,z]=a.useState(null),[v,B]=a.useState(null),[h,k]=a.useState(null),[b,y]=a.useState(null),[U,E]=a.useState(!1),[D,R]=a.useState(),q=t=>{E(!0),R(t)},F=()=>{z(null),B(null),k(null),y(null),m(null)},_=Math.ceil(r.length/l),A=t=>{L(t)},V=(t,s)=>{t.target.checked?N([...f,s]):N(f.filter(n=>n!==s))},Y=t=>{if(t.target.checked){const s=r.map(n=>n.id);N(s)}else N([])},T=()=>{const t=(o-1)*l,s=t+l;let n=r;return j&&(n=n.filter(x=>x.caption.toLowerCase().includes(j.toLowerCase()))),P&&(n=n.filter(x=>x.tahun.toLowerCase().includes(P.toLowerCase()))),v&&(n=n.filter(x=>x.kategori.toLowerCase().includes(v.toLowerCase()))),b&&(n=n.filter(x=>x.edisi.toLowerCase().includes(b.toLowerCase()))),h&&(n=n.filter(x=>x.penerbit.toLowerCase().includes(h.toLowerCase()))),n.slice(t,s)},$=t=>f.includes(t),G=()=>{f.forEach(async t=>{try{await J.delete(`/admin/buku/${t}`),window.location.reload()}catch(s){console.error("Error deleting data:",s)}})},M="data-buku";return e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute z-50 top-8 right-20",children:r.filter(t=>t.id===u).map((t,s)=>e.jsx("div",{className:"w-[300px] h-[460px]",children:e.jsx("img",{src:t.imageUrl==="null"|t.imageUrl===null?"/default-book.jpg":I+t.imageUrl,alt:"",className:"w-full h-full object-cover brightness-95 rounded-lg"})},s))}),e.jsxs("div",{className:"flex justify-between mb-2 items-center",children:[e.jsx("div",{className:"flex items-center relative",children:e.jsxs("div",{className:"flex text-xs items-center relative",children:[e.jsx("div",{onClick:F,children:e.jsx(C,{name:"Refresh All"})}),f.length>0&&e.jsx("div",{className:"w-10 ml-3",onClick:G,children:e.jsx("img",{src:"/delete.png",alt:"",className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"text-xs flex gap-5",children:[e.jsx("div",{children:e.jsxs(d,{children:[e.jsx(d.Trigger,{children:e.jsx(C,{name:`${v!==null?v:"Kategori"}`,className:"bg-opacity-10 bg-white/50"})}),e.jsxs(d.Content,{children:[e.jsx("div",{className:"absolute top-2 right-2 z-50",onClick:()=>B(null),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3 cursor-pointer"})}),e.jsx("div",{className:`${i.length>20?"h-[600px] overflow-auto":""}`,children:i.map((t,s)=>e.jsx("div",{className:"p-2 px-5 cursor-pointer",onClick:()=>B(t),children:e.jsx("p",{children:t})},s))})]})]})}),e.jsx("div",{children:e.jsxs(d,{children:[e.jsx(d.Trigger,{children:e.jsx(C,{name:`${P!==null?P:"Tahun"}`,className:"bg-opacity-10 bg-white/50"})}),e.jsxs(d.Content,{children:[e.jsx("div",{className:"absolute top-2 right-2 z-50",onClick:()=>z(null),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3 cursor-pointer"})}),e.jsx("div",{className:`${c.length>20?"h-[600px] overflow-auto":""}`,children:c.map((t,s)=>e.jsx("div",{className:"p-2 px-5 cursor-pointer",onClick:()=>z(t),children:e.jsx("p",{children:t})},s))})]})]})}),e.jsx("div",{children:e.jsxs(d,{children:[e.jsx(d.Trigger,{children:e.jsx(C,{name:`${h!==null?h:"Penerbit"}`,className:"bg-opacity-10 bg-white/50"})}),e.jsxs(d.Content,{children:[e.jsx("div",{className:"absolute top-2 right-2 z-50",onClick:()=>k(null),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3 cursor-pointer"})}),e.jsx("div",{className:`${w.length>20?"h-[600px] overflow-auto":""}`,children:w.map((t,s)=>e.jsx("div",{className:"p-2 px-5 cursor-pointer",onClick:()=>k(t),children:e.jsx("p",{children:t})},s))})]})]})}),e.jsx("div",{children:e.jsxs(d,{children:[e.jsx(d.Trigger,{children:e.jsx(C,{name:`${b!==null?b:"Edisi"}`,className:"bg-opacity-10 bg-white/50"})}),e.jsxs(d.Content,{children:[e.jsx("div",{className:"absolute top-2 right-2 z-50",onClick:()=>y(null),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3 cursor-pointer"})}),e.jsx("div",{className:`${g.length>20?"h-[600px] overflow-auto":""}`,children:g.map((t,s)=>e.jsx("div",{className:"p-2 px-5 cursor-pointer",onClick:()=>y(t),children:e.jsx("p",{children:t})},s))})]})]})}),e.jsx("div",{children:e.jsxs(d,{children:[e.jsx(d.Trigger,{children:e.jsx(C,{name:"Download",className:"bg-blue-50"})}),e.jsx(d.Content,{children:e.jsxs("div",{className:"flex flex-col gap-3 p-3 justify-start text-xs",children:[e.jsx(te,{elementId:M}),e.jsx(W,{pdfRef:p,fileName:"Daftar Buku"})]})})]})})]})]}),T().length===0&&e.jsx("p",{className:"text-red-500 text-center mb-5 text-xs",children:"Data tidak ditemukan, tidak ada data dengan nama tersebut"}),e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsxs("table",{ref:p,className:"absolute mt-0 table-auto w-full shadow-lg rounded-lg p-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"",children:[e.jsx("th",{className:"border-r px-2 md:px-3 py-2 font-bold rounded-tl text-sm",children:"No"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Nama Buku"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Kategori"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Penerbit"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-20",children:"Tahun"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Edisi"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-20",children:"Stok"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-20",children:"Edit"})]})}),e.jsx("tbody",{className:"relative text-sm",children:T().map((t,s)=>e.jsxs("tr",{className:`border-t ${$(t.id)?"bg-blue-100":""}`,children:[e.jsx("td",{className:"border-r px-3 py-2",children:s+1}),e.jsx("td",{className:"py-1 leading-6 px-3 capitalize line-clamp-2 overflow-hidden",children:t.caption}),e.jsx("td",{className:"border-r border-l py-1 px-3 capitalize leading-6",children:t.kategori}),e.jsx("td",{className:"py-1 leading-6 px-3 capitalize line-clamp-2 overflow-hidden",children:t.penerbit}),e.jsx("td",{className:"border-r border-l py-1 px-3 capitalize leading-6",children:t.tahun}),e.jsx("td",{className:"border-r py-1 px-3 capitalize leading-6",children:t.edisi}),e.jsx("td",{className:"border-r py-1 px-3 capitalize leading-6",children:t.stok}),e.jsx("td",{className:"relative group border-r py-1 px-3 capitalize text-center hover:bg-blue-50 cursor-pointer",onClick:()=>q(t.id),children:e.jsx("button",{children:e.jsx("img",{src:"/edit.png",alt:"",className:"w-3 h-3"})})})]},s))})]}),e.jsxs("table",{id:M,className:"hidden mt-10 md:mt-0 table-auto w-full shadow-lg rounded-lg p-5 bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"",children:[e.jsx("th",{className:"border-r px-2 md:px-3 py-2 font-bold rounded-tl text-sm",children:"No"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Nama Buku"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-56",children:"Kategori"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Penerbit"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-20",children:"Tahun"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Edisi"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Deskripsi"}),e.jsx("th",{className:"px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Cover"})]})}),e.jsx("tbody",{className:"relative text-sm",children:r.map((t,s)=>e.jsxs("tr",{className:`h-10 border-t ${$(t.id)?"bg-blue-100":""}`,children:[e.jsx("td",{className:"border-r px-3 py-2",children:s+1}),e.jsx("td",{className:"border-r py-1 leading-6 px-3 capitalize line-clamp-2 overflow-hidden",children:t.caption}),e.jsx("td",{className:"border-r py-1 px-3 capitalize leading-6",children:t.kategori}),e.jsx("td",{className:"border-r py-1 leading-6 px-3 capitalize line-clamp-2 overflow-hidden",children:t.penerbit}),e.jsx("td",{className:"border-r py-1 px-3 capitalize leading-6",children:t.tahun}),e.jsx("td",{className:"border-r py-1 px-3 capitalize leading-6",children:t.edisi}),e.jsx("td",{className:"border-r py-1 px-3 capitalize",children:t.desc}),e.jsx("td",{className:"border-r py-1 px-3 capitalize",children:t.imageUrl})]},s))})]}),e.jsxs("table",{className:"relative mt-10 md:mt-0 table-auto w-full shadow-lg rounded-lg p-5 bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"",children:[e.jsx("th",{className:"border-r px-2 md:px-3 py-2 font-bold rounded-tl text-start text-blue-500",children:e.jsx("input",{type:"checkbox",className:"rounded outline-0",onChange:Y})}),e.jsx("th",{className:"px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Nama Buku"}),e.jsx("th",{className:"border-r border-l px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Kategori"}),e.jsx("th",{className:"px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Penerbit"}),e.jsx("th",{className:"border-r border-l px-2 md:px-3 py-4 font-bold text-start text-sm w-20",children:"Tahun"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Edisi"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-20",children:"Stok"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-20",children:"Edit"})]})}),e.jsx("tbody",{className:"relative text-sm",children:T().map((t,s)=>e.jsxs("tr",{className:`h-10 border-t ${$(t.id)|u===t.id?"bg-blue-100":""}`,children:[e.jsx("td",{className:"border-r px-3 py-2",children:e.jsx("input",{type:"checkbox",id:`select-${t.id}`,className:"rounded outline-0",checked:$(t.id),onChange:n=>V(n,t.id)})}),e.jsx("td",{className:"py-1 leading-6 px-3 capitalize line-clamp-2 overflow-hidden",children:t.caption}),e.jsx("td",{className:"border-r border-l py-1 px-3 capitalize leading-6",children:t.kategori}),e.jsx("td",{className:"py-1 leading-6 px-3 capitalize line-clamp-2 overflow-hidden",children:t.penerbit}),e.jsx("td",{className:"border-r border-l py-1 px-3 capitalize leading-6",children:t.tahun}),e.jsx("td",{className:"border-r py-1 px-3 capitalize leading-6",children:t.edisi}),e.jsx("td",{className:"border-r py-1 px-3 capitalize leading-6",children:t.stok}),e.jsx("td",{className:"relative group border-r py-1 px-3 capitalize text-center hover:bg-blue-50 cursor-pointer",onClick:()=>q(t.id),onMouseOver:()=>S(t.id),onMouseOut:()=>S(null),children:e.jsx("button",{children:e.jsx("img",{src:"/edit.png",alt:"",className:"w-3 h-3"})})})]},s))})]})]}),e.jsx("div",{}),U&&e.jsx(K,{children:e.jsx("div",{className:"",children:e.jsx(re,{id:D,handleClose:()=>E(!1)})})}),e.jsx("div",{className:"mb-20",children:e.jsx(se,{currentPage:o,totalPages:_,onPageChange:A,data:r})})]})})}function je({auth:r,bukus:p,users:j,pinjamans:m}){const i=m.filter(D=>D.status_peminjaman==="meminjam"),c=m.filter(D=>D.status_peminjaman==="dikembalikan"),w=p.length,g=j.length,l=m.length,o=w/g,L=Math.round(o),f=Math.round(l/g),N=r.user.role;a.useEffect(()=>{N==="anggota"&&(window.location.href="/daftar-buku")});const[u,S]=a.useState(!1),[P,z]=a.useState(!1),v="/logo.png",B=()=>{S(!u),z(!1)},[h,k]=a.useState(!1),[b,y]=a.useState(!1),U=()=>{k(!h)},E=()=>{y(!b)};return e.jsx("div",{children:N==="admin"&&e.jsxs("div",{children:[e.jsx("div",{className:`transition-all duration-500 h-screen absolute z-50 backdrop-blur-md bg-opacity-10 bg-white/30 ${h?"w-[300px]":"w-0"}`,children:e.jsxs("div",{className:`transition-all duration-200 p-5 ${h?"block":"hidden"}`,children:[e.jsx("div",{className:"flex justify-end cursor-pointer",onClick:()=>k(!1),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3"})}),e.jsx(ee,{id:r.user.id})]})}),e.jsx("div",{className:`transition-all duration-500 h-screen absolute z-50 bg-white ${b?"w-[300px]":"w-0"}`,children:e.jsxs("div",{className:`transition-all duration-200 p-5 ${b?"block":"hidden"}`,children:[e.jsx("div",{className:"flex justify-end cursor-pointer",onClick:()=>y(!1),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3"})}),e.jsx(X,{id:r.user.id})]})}),e.jsx(Q,{title:"Daftar Buku"}),e.jsx(Z,{profile:I+r.user.foto_profil,logo:v,handleMenu:B,showIcon:!u,auth:r.user.nama,handleSetting:U,handleBookmark:E}),e.jsx("div",{className:"absolute w-20 overflow-hidden",children:e.jsx(O,{})}),e.jsxs("div",{className:`absolute transition-all duration-500 w-[300px] z-50 backdrop-blur-sm bg-white/75 h-screen ${u?"ml-0":"-ml-96"}`,children:[e.jsx("button",{onClick:()=>S(!u),children:e.jsx("img",{src:"/close.png",alt:"",className:`transition-all duration-1000 w-5 h-5 relative top-4 left-64 ${u?"rotate-0":"rotate-90"}`})}),e.jsx("div",{className:"-mt-7",children:e.jsx(O,{viewicon:!0,bukus:p.length,pinjamans:m.length,bukuDikembalikan:c.length,bukuDipinjam:i.length,users:j.length,ratio:L,probabilitas:f})})]}),e.jsx("div",{children:e.jsxs("div",{className:"w-full h-screen",children:[e.jsx("img",{src:"/footer.jpg",alt:"",className:"w-full h-screen object-cover"}),e.jsx("div",{className:"inset-0 absolute top-20 left-0 ml-20 p-5 bg-opacity-10 bg-white/75 rounded-lg",children:e.jsx(ae,{data:p})})]})})]})})}export{je as default};
