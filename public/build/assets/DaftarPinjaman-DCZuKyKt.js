import{r as i,M as G,j as e,a as H,Y as J}from"./app-CIR9jD88.js";import{D as E,C as Q,N as W,S as R}from"./CreateBook-tiMENIzZ.js";import{u as X}from"./Url-Bx3CnFKe.js";import{E as Z}from"./EditUser-CccXl81N.js";import{B as f}from"./Button-CldEM8zS.js";import{D as ee,P as ae}from"./Pagination-L2o3LzjI.js";import{D as n}from"./Dropdown-DZThBfFS.js";import{P as q}from"./PopOver-D0qxf1oD.js";import se from"./DetailDaftarPinjaman-Dl8AxYx8.js";import"./index-QLmAPZR6.js";import"./index-CbqRHeaS.js";import"./transition-TRJyF6WF.js";function te({data:l}){const m=i.useRef(),P=new Date().toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),{value:c,setValue:B}=i.useContext(G),_=[...new Set(l.map(a=>a.nama_peminjam.toLocaleLowerCase()))],S=[...new Set(l.map(a=>a.tanggal_pinjam.toLocaleLowerCase()))],k=[...new Set(l.map(a=>a.tanggal_pengembalian.toLocaleLowerCase()))],L=[...new Set(l.map(a=>a.status_peminjaman.toLocaleLowerCase()))],w=10,[D,$]=i.useState(1),[o,r]=i.useState([]),[x,v]=i.useState(null),[b,p]=i.useState(null),[h,u]=i.useState(null),[j,y]=i.useState(null),[z,N]=i.useState(),[F,T]=i.useState(!1),A=()=>{v(null),p(null),u(null),y(null),B(null)},K=Math.ceil(l.length/w),U=a=>{$(a)},M=(a,s)=>{a.target.checked?r([...o,s]):r(o.filter(t=>t!==s))},O=a=>{if(a.target.checked){const s=l.map(t=>t.id);r(s)}else r([])},V=a=>{N(a)},g=()=>{const a=(D-1)*w,s=a+w;let t=l;return c&&(t=t.filter(d=>d.nama_buku.toLowerCase().includes(c.toLowerCase()))),x&&(t=t.filter(d=>d.nama_peminjam.toLowerCase().includes(x.toLowerCase()))),b&&(t=t.filter(d=>d.tanggal_pinjam.toLowerCase().includes(b.toLowerCase()))),h&&(t=t.filter(d=>d.tanggal_pengembalian.toLowerCase().includes(h.toLowerCase()))),j&&(t=t.filter(d=>d.status_peminjaman.toLowerCase().includes(j.toLowerCase()))),t.slice(a,s)},C=a=>o.includes(a),Y=()=>{o.forEach(async a=>{try{await H.delete(`/admin/daftarpinjaman-delete/${a}`),window.location.reload()}catch(s){console.error("Error deleting data:",s)}})},I="data-buku";return e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[F&&e.jsx(q,{children:e.jsxs("div",{className:"bg-white p-5 rounded-lg text-xs w-[842px]",children:[e.jsx("div",{className:"flex justify-end cursor-pointer",onClick:()=>T(!1),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-4 h-4"})}),e.jsxs("div",{className:"px-5",id:"downloadInvoice",ref:m,children:[e.jsxs("div",{className:"flex flex-row gap-5 border-b-2 pb-2 border-black border-double mb-5",children:[e.jsx("div",{className:"",children:e.jsx("img",{src:"/logo.png",alt:"",className:"w-[60px]"})}),e.jsxs("div",{className:"text-center w-full",children:[e.jsx("h1",{className:"font-bold uppercase",children:"surat keterangan peminjam buku"}),e.jsx("h1",{className:"font-bold uppercase",children:"perpustakaan smk muhammadiyah bobotsari"}),e.jsx("p",{className:"text-[10px]",children:"Jl. RS. Yosomiharjo No.8, Bobotsari, Purbalingga"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-2",children:[e.jsx("div",{children:e.jsx("h1",{className:"font-bold w-32",children:"Nama Peminjam"})}),e.jsx("div",{children:(()=>{const a={};return g().filter(s=>a[s.nama_peminjam]?!1:(a[s.nama_peminjam]=!0,!0)).map(s=>e.jsx("div",{children:e.jsxs("p",{className:"uppercase font-bold",children:[":"," ",s.nama_peminjam]})},s.id))})()})]}),e.jsxs("div",{className:"flex gap-3 mt-2",children:[e.jsx("div",{children:e.jsx("h1",{className:"font-bold w-32",children:"Nama Buku"})}),e.jsx("div",{children:g().map((a,s)=>e.jsx("div",{children:e.jsxs("p",{children:[": ",s+1,"."," ",e.jsx("span",{className:"ml-2",children:a.nama_buku})]})},a.id))})]}),e.jsxs("div",{className:"flex gap-3 mt-2",children:[e.jsx("div",{children:e.jsx("h1",{className:"font-bold w-32",children:"Tanggal Pinjam"})}),e.jsx("div",{children:(()=>{const a={};return g().filter(s=>a[s.tanggal_pinjam]?!1:(a[s.tanggal_pinjam]=!0,!0)).map(s=>e.jsx("div",{children:e.jsxs("p",{children:[":"," ",s.tanggal_pinjam]})},s.id))})()})]}),e.jsxs("div",{className:"flex gap-3 mt-2",children:[e.jsx("div",{children:e.jsx("h1",{className:"font-bold w-32",children:"Tanggal Kembalikan"})}),e.jsx("div",{children:(()=>{const a={};return g().filter(s=>a[s.tanggal_pengembalian]?!1:(a[s.tanggal_pengembalian]=!0,!0)).map(s=>e.jsx("div",{children:e.jsxs("p",{children:[":"," ",s.tanggal_pengembalian]})},s.id))})()})]}),e.jsx("div",{children:e.jsxs("p",{className:"indent-8 mt-3 leading-6 text-justify",children:["Surat keterangan peminjaman buku ini digunakan sebagai bukti peminjaman buku di perpustakaan SMK Muhammadiyah Bobotsari,"," ",e.jsx("span",{className:"font-bold",children:"harap dikembalikan sebagai bukti pengembalian peminjaman buku."})]})}),e.jsx("div",{className:"flex justify-end mt-5",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("p",{children:["Purbalingga, ",P]}),e.jsx("p",{children:"Pengurus,"}),e.jsx("img",{src:"/ttd.png",alt:"",className:"w-32 mx-auto absolute"}),e.jsx("p",{className:"mt-12 font-bold text-center pb-5",children:"Sulistyo S.T., M.Pd.,"})]})})]}),e.jsx(E,{pdfRef:m,fileName:"Invoice.pdf"})]})}),e.jsxs("div",{className:"flex justify-between mb-2 items-center",children:[e.jsxs("div",{className:"flex text-xs items-center relative",children:[e.jsx("div",{onClick:A,children:e.jsx(f,{name:"Refresh All"})}),o.length>0&&e.jsx("div",{className:"w-10 ml-3",onClick:Y,children:e.jsx("img",{src:"/delete.png",alt:"",className:"w-5 h-5"})})]}),e.jsxs("div",{className:"text-xs flex gap-5",children:[e.jsx("div",{children:e.jsxs(n,{children:[e.jsx(n.Trigger,{children:e.jsx(f,{name:`${x!==null?x:"Nama Peminjam"}`,className:"bg-opacity-10 bg-white/50"})}),e.jsxs(n.Content,{children:[e.jsx("div",{className:"absolute top-2 right-2 z-50",onClick:()=>v(null),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3 cursor-pointer"})}),e.jsx("div",{className:`${_.length>20?"h-[600px] overflow-auto":""}`,children:_.map((a,s)=>e.jsx("div",{className:"p-2 px-5 cursor-pointer",onClick:()=>v(a),children:e.jsx("p",{children:a})},s))})]})]})}),e.jsx("div",{children:e.jsxs(n,{children:[e.jsx(n.Trigger,{children:e.jsx(f,{name:`${b!==null?b:"Tanggal Meminjam"}`,className:"bg-opacity-10 bg-white/50"})}),e.jsxs(n.Content,{children:[e.jsx("div",{className:"absolute top-2 right-2 z-50",onClick:()=>p(null),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3 cursor-pointer"})}),e.jsx("div",{className:`${S.length>20?"h-[600px] overflow-auto":""}`,children:S.map((a,s)=>e.jsx("div",{className:"p-2 px-5 cursor-pointer",onClick:()=>p(a),children:e.jsx("p",{children:a})},s))})]})]})}),e.jsx("div",{children:e.jsxs(n,{children:[e.jsx(n.Trigger,{children:e.jsx(f,{name:`${h!==null?h:"Tanggal Pengembalian"}`,className:"bg-opacity-10 bg-white/50"})}),e.jsxs(n.Content,{children:[e.jsx("div",{className:"absolute top-2 right-2 z-50",onClick:()=>u(null),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3 cursor-pointer"})}),e.jsx("div",{className:`${k.length>20?"h-[600px] overflow-auto":""}`,children:k.map((a,s)=>e.jsx("div",{className:"p-2 px-5 cursor-pointer",onClick:()=>u(a),children:e.jsx("p",{children:a})},s))})]})]})}),e.jsx("div",{children:e.jsxs(n,{children:[e.jsx(n.Trigger,{children:e.jsx(f,{name:`${j!==null?j:"Status"}`,className:"bg-opacity-10 bg-white/50"})}),e.jsxs(n.Content,{children:[e.jsx("div",{className:"absolute top-2 right-2 z-50",onClick:()=>y(null),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3 cursor-pointer"})}),L.map((a,s)=>e.jsx("div",{className:"p-2 px-5 cursor-pointer",onClick:()=>y(a),children:e.jsx("p",{children:a})},s))]})]})}),e.jsx("div",{children:e.jsxs(n,{children:[e.jsx(n.Trigger,{children:e.jsx(f,{name:"Download",className:"bg-blue-50"})}),e.jsx(n.Content,{children:e.jsxs("div",{className:"flex flex-col gap-3 p-3 justify-start text-xs",children:[e.jsx(ee,{elementId:I}),e.jsx(E,{pdfRef:m,fileName:"Data peminjam"}),e.jsx("div",{className:"bg-black text-white w-32 p-1 rounded-sm cursor-pointer text-center",children:e.jsx("button",{onClick:()=>T(!0),children:"Print Invoice"})})]})})]})})]})]}),g().length===0&&e.jsx("p",{className:"text-red-500 text-center mb-5 text-xs",children:"Data tidak ditemukan, tidak ada data dengan nama tersebut"}),e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsxs("table",{id:"data-buku-pdf",ref:m,className:"absolute mt-0 table-auto w-full shadow-lg rounded-lg p-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-t",children:[e.jsx("th",{className:"border-r px-2 md:px-3 py-2 font-bold rounded-tl text-sm",children:"No"}),e.jsx("th",{className:"px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Nama Peminjam"}),e.jsx("th",{className:"border-r border-l px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Nama Buku"}),e.jsx("th",{className:"px-2 md:px-3 py-4 font-bold text-start text-sm w-64",children:"Tanggal Pinjam"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-64",children:"Tanggal Pengembalian"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-64",children:"Status"}),e.jsx("th",{className:" border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Keterangan"})]})}),e.jsx("tbody",{className:"relative text-sm border-b",children:g().map((a,s)=>e.jsxs("tr",{className:`h-10 border-t ${C(a.id)?"bg-blue-100":""}`,children:[e.jsx("td",{className:"border-r px-3 py-2",children:e.jsx("input",{type:"checkbox",id:`select-${a.id}`,className:"rounded outline-0",checked:C(a.id),onChange:t=>M(t,a.id)})}),e.jsx("td",{className:"py-1 leading-6 px-3 capitalize",children:a.nama_peminjam}),e.jsx("td",{className:"border-r border-l py-1 px-3 capitalize leading-6 line-clamp-1 pt-2",children:a.nama_buku}),e.jsx("td",{className:"py-1 leading-6 px-3 capitalize",children:a.tanggal_pinjam}),e.jsx("td",{className:"border-r py-1 px-3 capitalize leading-6",children:a.tanggal_pengembalian}),e.jsx("td",{className:`border-r py-1 px-3 capitalize leading-6 ${a.status_peminjaman.toLowerCase()==="dikembalikan"?"text-green-500":"text-red-500"}`,children:a.status_peminjaman}),e.jsx("td",{className:"border-r border-l py-1 px-3 leading-6 truncate",children:a.keterangan===null?"Belum ada keterangan":a.keterangan})]},s))})]}),e.jsxs("table",{id:I,className:"hidden mt-10 md:mt-0 table-auto w-full shadow-lg rounded-lg p-5 bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"",children:[e.jsx("th",{className:"border-r px-2 md:px-3 py-2 font-bold rounded-tl text-sm",children:"No"}),e.jsx("th",{className:"px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Nama Peminjam"}),e.jsx("th",{className:"border-r border-l px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Nama Buku"}),e.jsx("th",{className:"px-2 md:px-3 py-4 font-bold text-start text-sm w-64",children:"Tanggal Pinjam"}),e.jsx("th",{className:"border-r border-l px-2 md:px-3 py-4 font-bold text-start text-sm w-20",children:"Estimasi"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-64",children:"Tanggal Pengembalian"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-64",children:"Status"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-64",children:"Kontak"})]})}),e.jsx("tbody",{className:"relative text-sm",children:l.map((a,s)=>e.jsxs("tr",{className:`h-10 border-t ${C(a.id)?"bg-blue-100":""}`,children:[e.jsx("td",{className:"border-r px-3 py-2",children:s+1}),e.jsx("td",{className:"py-1 leading-6 px-3 capitalize",children:a.nama_peminjam}),e.jsx("td",{className:"border-r border-l py-1 px-3 capitalize leading-6 line-clamp-1 pt-2",children:a.nama_buku}),e.jsx("td",{className:"py-1 leading-6 px-3 capitalize",children:a.tanggal_pinjam}),e.jsxs("td",{className:"border-r border-l py-1 px-3 capitalize leading-6",children:[a.estimasi," Hari"]}),e.jsx("td",{className:"border-r py-1 px-3 capitalize leading-6",children:a.tanggal_pengembalian}),e.jsx("td",{className:`border-r py-1 px-3 capitalize leading-6 ${a.status_peminjaman.toLowerCase()==="dikembalikan"?"bg-green-50":"bg-red-50"}`,children:a.status_peminjaman}),e.jsx("td",{className:"border-r py-1 px-3 capitalize leading-6",children:a.kontak_peminjam})]},s))})]}),e.jsxs("table",{className:"relative mt-10 md:mt-0 table-auto w-full shadow-lg rounded-lg p-5 bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"",children:[e.jsx("th",{className:"border-r px-2 md:px-3 py-2 font-bold rounded-tl text-start text-blue-500",children:e.jsx("input",{type:"checkbox",className:"rounded outline-0",onChange:O})}),e.jsx("th",{className:"px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Nama Peminjam"}),e.jsx("th",{className:"border-r border-l px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Nama Buku"}),e.jsx("th",{className:"px-2 md:px-3 py-4 font-bold text-start text-sm w-64",children:"Tanggal Pinjam"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-64",children:"Tanggal Pengembalian"}),e.jsx("th",{className:"border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-64",children:"Status"}),e.jsx("th",{className:" border-r px-2 md:px-3 py-4 font-bold text-start text-sm w-96",children:"Keterangan"}),e.jsx("th",{className:"px-2 md:px-3 py-4 font-bold text-start text-sm w-20",children:"Aksi"})]})}),e.jsx("tbody",{className:"relative text-sm",children:g().map((a,s)=>e.jsxs("tr",{className:`h-10 border-t ${C(a.id)?"bg-blue-100":""}`,children:[e.jsx("td",{className:"border-r px-3 py-2",children:e.jsx("input",{type:"checkbox",id:`select-${a.id}`,className:"rounded outline-0",checked:C(a.id),onChange:t=>M(t,a.id)})}),e.jsx("td",{className:"py-1 leading-6 px-3 capitalize",children:a.nama_peminjam}),e.jsx("td",{className:"border-r border-l py-1 px-3 capitalize leading-6 line-clamp-1 pt-2",children:a.nama_buku}),e.jsx("td",{className:"py-1 leading-6 px-3 capitalize",children:a.tanggal_pinjam}),e.jsx("td",{className:"border-r py-1 px-3 capitalize leading-6",children:a.tanggal_pengembalian}),e.jsx("td",{className:`border-r py-1 px-3 capitalize leading-6 ${a.status_peminjaman.toLowerCase()==="dikembalikan"?"text-green-500":"text-red-500"}`,children:a.status_peminjaman}),e.jsx("td",{className:"border-r border-l py-1 px-3 leading-6 truncate",children:a.keterangan===null?"Belum ada keterangan":a.keterangan}),e.jsx("td",{className:"relative group border-r py-1 px-3 capitalize text-center hover:bg-blue-50 cursor-pointer",onClick:()=>V(a.id),children:e.jsx("button",{children:e.jsx("img",{src:"/edit.png",alt:"",className:"w-3 h-3"})})})]},s))})]})]}),z&&e.jsx(q,{children:e.jsx(se,{id:z,handleClose:()=>N(null)})}),e.jsx("div",{className:"mb-20",children:e.jsx(ae,{currentPage:D,totalPages:K,onPageChange:U,data:l})})]})})}function ge({auth:l,bukus:m,users:P,pinjamans:c}){const B=c.filter(N=>N.status_peminjaman==="meminjam"),_=c.filter(N=>N.status_peminjaman==="dikembalikan"),S=m.length,k=P.length,L=c.length,w=S/k,D=Math.round(w),$=Math.round(L/k),o=l.user.role;i.useEffect(()=>{o==="anggota"&&(window.location.href="/daftar-buku")});const[r,x]=i.useState(!1),v="/logo.png",b=()=>{x(!r)},[p,h]=i.useState(!1),[u,j]=i.useState(!1),y=()=>{h(!p)},z=()=>{j(!u)};return e.jsx("div",{children:o==="admin"&&e.jsxs("div",{children:[e.jsx("div",{className:`transition-all duration-500 h-screen absolute z-50 backdrop-blur-md bg-opacity-10 bg-white/30 ${p?"w-[300px]":"w-0"}`,children:e.jsxs("div",{className:`transition-all duration-200 p-5 ${p?"block":"hidden"}`,children:[e.jsx("div",{className:"flex justify-end cursor-pointer",onClick:()=>h(!1),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3"})}),e.jsx(Z,{id:l.user.id})]})}),e.jsx("div",{className:`transition-all duration-500 h-screen absolute z-50 bg-white ${u?"w-[300px]":"w-0"}`,children:e.jsxs("div",{className:`transition-all duration-200 p-5 ${u?"block":"hidden"}`,children:[e.jsx("div",{className:"flex justify-end cursor-pointer",onClick:()=>j(!1),children:e.jsx("img",{src:"/close.png",alt:"",className:"w-3 h-3"})}),e.jsx(Q,{id:l.user.id})]})}),e.jsx(J,{title:"Daftar Pinjaman"}),e.jsx(W,{profile:X+l.user.foto_profil,logo:v,handleMenu:b,showIcon:!r,auth:l.user.nama,handleSetting:y,handleBookmark:z}),e.jsx("div",{className:"absolute w-20 overflow-hidden",children:e.jsx(R,{})}),e.jsxs("div",{className:`absolute transition-all duration-500 w-[300px] z-50 backdrop-blur-sm bg-white/75 h-screen ${r?"ml-0":"-ml-96"}`,children:[e.jsx("button",{onClick:()=>x(!r),children:e.jsx("img",{src:"/close.png",alt:"",className:`transition-all duration-1000 w-5 h-5 relative top-4 left-64 ${r?"rotate-0":"rotate-90"}`})}),e.jsx("div",{className:"-mt-7",children:e.jsx(R,{viewicon:!0,bukus:m.length,pinjamans:c.length,bukuDikembalikan:_.length,bukuDipinjam:B.length,users:P.length,ratio:D,probabilitas:$})})]}),e.jsx("div",{children:e.jsxs("div",{className:"w-full h-screen",children:[e.jsx("img",{src:"/footer.jpg",alt:"",className:"w-full h-screen object-cover"}),e.jsx("div",{className:"inset-0 absolute top-20 left-0 ml-20 p-5 bg-opacity-10 bg-white/75 rounded-lg",children:e.jsx(te,{data:c})})]})})]})})}export{ge as default};
